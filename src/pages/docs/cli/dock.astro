---
import DocsLayout from '../../../layouts/DocsLayout.astro'
import DocTerminal from '../../../components/DocTerminal.astro'
import Flags from '../../../components/Flags.astro'
import CodeBlock from '../../../components/CodeBlock.astro'
import LeadMagnetCallout from '../../../components/LeadMagnetCallout.astro'
---

<DocsLayout title="buoy dock" description="Dock Buoy into your project with config, agents, skills, hooks, commands, and plugins">
  <h1>buoy dock</h1>

  <p>
    Dock Buoy into your project. With no arguments, runs an interactive
    walkthrough that configures your project, sets up agents, and installs hooks.
    Use subcommands to set up individual pieces.
  </p>

  <h2>Usage</h2>

  <DocTerminal command="buoy dock [command] [options]" />

  <h2>Commands</h2>

  <Flags items={[
    { name: "(default)", description: "Run interactive walkthrough (config → agents → hooks)" },
    { name: "config", description: "Create or update .buoy.yaml configuration" },
    { name: "agents", description: "Set up AI agent files (.claude/agents/)" },
    { name: "skills", description: "Install Buoy skills (.claude/skills/)" },
    { name: "context", description: "Generate CLAUDE.md with design system context" },
    { name: "hooks", description: "Set up pre-commit and CI hooks" },
    { name: "commands", description: "Manage Claude Code slash commands" },
    { name: "plugins", description: "Manage scanners and framework plugins" },
    { name: "tokens", description: "Generate, compare, and import design tokens" },
    { name: "graph", description: "Build and query the design system knowledge graph" },
  ]} />

  <h2>Options</h2>

  <Flags items={[
    { name: "-y, --yes", description: "Accept all defaults without prompting" },
    { name: "--json", description: "Output results as JSON" },
    { name: "-f, --force", description: "Overwrite existing files" },
  ]} />

  <h2>Examples</h2>

  <h3>Interactive walkthrough</h3>

  <DocTerminal command="buoy dock" lines={[
    { text: "" },
    { text: "Detecting project configuration..." },
    { text: "" },
    { text: "Detected:", type: "info" },
    { text: "  Framework: React" },
    { text: "  Styling: Tailwind CSS" },
    { text: "  Components: src/components/" },
    { text: "" },
    { text: "Step 1/3: Configuration" },
    { text: "✓ Created .buoy.yaml", type: "success" },
    { text: "" },
    { text: "Step 2/3: AI Agents" },
    { text: "✓ Created .claude/agents/design-reviewer.md", type: "success" },
    { text: "✓ Created .claude/agents/drift-fixer.md", type: "success" },
    { text: "" },
    { text: "Step 3/3: Hooks" },
    { text: "✓ Created .claude/commands/buoy-check.md", type: "success" },
    { text: "✓ Updated .claude/settings.local.json", type: "success" },
    { text: "" },
    { text: "Buoy is docked! Run 'buoy drift check' to scan your codebase.", type: "success" },
  ]} />

  <h2 id="config">buoy dock config</h2>

  <DocTerminal command="buoy dock config" lines={[
    { text: "" },
    { text: "Detecting project configuration..." },
    { text: "" },
    { text: "Detected:", type: "info" },
    { text: "  Framework: React" },
    { text: "  Styling: Tailwind CSS" },
    { text: "  Components: src/components/" },
    { text: "" },
    { text: "✓ Created .buoy.yaml", type: "success" },
  ]} />

  <h2 id="agents">buoy dock agents</h2>

  <DocTerminal command="buoy dock agents" lines={[
    { text: "" },
    { text: "✓ Created .claude/agents/design-reviewer.md", type: "success" },
    { text: "✓ Created .claude/agents/drift-fixer.md", type: "success" },
    { text: "" },
    { text: "Agents are ready. Use them in Claude Code with /agent." },
  ]} />

  <h2 id="skills">buoy dock skills</h2>

  <DocTerminal command="buoy dock skills" lines={[
    { text: "" },
    { text: "✓ Created .claude/skills/design-system.md", type: "success" },
    { text: "✓ Created .claude/skills/drift-check.md", type: "success" },
    { text: "" },
    { text: "Skills installed. Claude Code will use them automatically." },
  ]} />

  <h2 id="context">buoy dock context</h2>

  <p>
    Scans your codebase for components and tokens, then generates CLAUDE.md with
    design system context so AI tools understand and follow your design system.
  </p>

  <DocTerminal command="buoy dock context" lines={[
    { text: "" },
    { text: "Analyzing design system..." },
    { text: "" },
    { text: "✓ Generated CLAUDE.md with design system rules", type: "success" },
    { text: "  - 67 tokens documented" },
    { text: "  - 42 components listed" },
    { text: "  - Anti-patterns defined" },
  ]} />

  <p>
    AI coding tools read these files to understand your design system. When you ask
    "Build a card component", the AI will:
  </p>

  <ol>
    <li>Check your existing Card component (if any)</li>
    <li>Use your color tokens instead of hardcoding <code>#3b82f6</code></li>
    <li>Follow your spacing scale instead of arbitrary values</li>
    <li>Match your naming conventions</li>
  </ol>

  <h2 id="hooks">buoy dock hooks</h2>

  <DocTerminal command="buoy dock hooks" lines={[
    { text: "" },
    { text: "✓ Created .claude/commands/buoy-check.md", type: "success" },
    { text: "✓ Updated .claude/settings.local.json", type: "success" },
    { text: "✓ Created .git/hooks/pre-commit", type: "success" },
    { text: "" },
    { text: "Hooks installed:" },
    { text: "  Pre-commit: drift check before each commit" },
    { text: "  Claude Code: self-validating AI hooks" },
  ]} />

  <h3>Non-interactive setup</h3>

  <DocTerminal command="buoy dock -y" lines={[
    { text: "" },
    { text: "✓ Created .buoy.yaml", type: "success" },
    { text: "✓ Created .claude/agents/design-reviewer.md", type: "success" },
    { text: "✓ Created .claude/agents/drift-fixer.md", type: "success" },
    { text: "✓ Created .claude/commands/buoy-check.md", type: "success" },
    { text: "✓ Updated .claude/settings.local.json", type: "success" },
    { text: "" },
    { text: "Buoy is docked!", type: "success" },
  ]} />

  <h3>Force overwrite</h3>

  <DocTerminal command="buoy dock config -f" lines={[
    { text: "" },
    { text: "Overwriting existing .buoy.yaml...", type: "warning" },
    { text: "✓ Updated .buoy.yaml", type: "success" },
  ]} />

  <!-- ─────────────────────────────────────────── -->
  <h2 id="commands">buoy dock commands</h2>

  <p>
    Install Buoy's slash commands to Claude Code. These commands give you quick access
    to design system workflows directly from Claude Code's command palette.
  </p>

  <DocTerminal command="buoy dock commands list" />
  <DocTerminal command="buoy dock commands install" />

  <h3>Subcommands</h3>

  <Flags items={[
    { name: "list", description: "List available Buoy slash commands and installation status" },
    { name: "install", description: "Install commands to ~/.claude/commands/" },
  ]} />

  <h3>Options</h3>

  <Flags items={[
    { name: "--dry-run", description: "Show what would be installed without writing files" },
    { name: "--json", description: "Output result as JSON" },
  ]} />

  <h3>Available Commands</h3>

  <h4>/contribution-loop</h4>

  <p>
    Autonomous workflow for finding repos with design drift and generating PRs to fix them.
    Runs through discovery, scanning, analysis, and PR generation phases.
  </p>

  <p>Phases:</p>

  <ol>
    <li><strong>Discovery</strong> — Find repos using design systems on GitHub</li>
    <li><strong>Scanning</strong> — Run Buoy to detect drift</li>
    <li><strong>Analysis</strong> — Use agents to assess fixability</li>
    <li><strong>Triage</strong> — Classify as slam-dunk, review, or skip</li>
    <li><strong>Generation</strong> — Create PR with full context</li>
    <li><strong>Review</strong> — Human approval before submission</li>
  </ol>

  <h3>Example Output</h3>

  <DocTerminal command="buoy dock commands list" lines={[
    { text: "" },
    { text: "  Available Buoy Commands" },
    { text: "" },
    { text: "  /contribution-loop  not installed", type: "muted" },
    { text: "" },
    { text: "  Run `buoy dock commands install` to install all commands" },
  ]} />

  <DocTerminal command="buoy dock commands install" lines={[
    { text: "" },
    { text: "  ✓ Installed slash commands:", type: "success" },
    { text: "" },
    { text: "    /contribution-loop" },
    { text: "" },
    { text: "  Commands installed to: ~/.claude/commands/" },
    { text: "  Restart Claude Code to use them" },
  ]} />

  <h3>Commands vs Skills</h3>

  <p>
    <strong>Commands</strong> are user-invocable — you type <code>/contribution-loop</code>
    in Claude Code to trigger them. <strong>Skills</strong> are AI-invocable — Claude
    automatically loads them when relevant.
  </p>

  <p>
    Use <code>buoy dock context</code> to create skills, and <code>buoy dock commands install</code>
    to install slash commands.
  </p>

  <!-- ─────────────────────────────────────────── -->
  <h2 id="plugins">buoy dock plugins</h2>

  <p>
    Manage scanners and framework plugins. List built-in and installed plugins,
    or get suggestions based on your project's detected frameworks.
  </p>

  <DocTerminal command="buoy dock plugins <command>" />

  <h3>Subcommands</h3>

  <Flags items={[
    { name: "list", description: "List built-in scanners and installed plugins" },
    { name: "suggest", description: "Detect frameworks and recommend plugins" },
  ]} />

  <h3>List plugins</h3>

  <DocTerminal command="buoy dock plugins list" lines={[
    { text: "" },
    { text: "Built-in Scanners" },
    { text: "─────────────────" },
    { text: "Scanner              Status     Description" },
    { text: "color                active     Detect hardcoded color values", type: "success" },
    { text: "spacing              active     Detect hardcoded spacing values", type: "success" },
    { text: "typography           active     Detect hardcoded font sizes and weights", type: "success" },
    { text: "naming               active     Check naming conventions", type: "success" },
    { text: "z-index              active     Detect arbitrary z-index values", type: "success" },
    { text: "" },
    { text: "Installed Plugins" },
    { text: "─────────────────" },
    { text: "Plugin               Version    Description" },
    { text: "@buoy/tailwind       0.3.17      Tailwind CSS utilities and class scanning" },
    { text: "@buoy/react          0.3.17      React component detection and JSX parsing" },
  ]} />

  <h3>Suggest plugins</h3>

  <DocTerminal command="buoy dock plugins suggest" lines={[
    { text: "" },
    { text: "Detecting project frameworks..." },
    { text: "" },
    { text: "Detected:", type: "info" },
    { text: "  React 18.2.0" },
    { text: "  Tailwind CSS 3.4.1" },
    { text: "  Storybook 7.6.0" },
    { text: "" },
    { text: "Recommended Plugins" },
    { text: "───────────────────" },
    { text: "Plugin               Why" },
    { text: "@buoy/tailwind       Tailwind detected — scan utility classes for drift" },
    { text: "@buoy/react          React detected — parse JSX for component patterns" },
    { text: "@buoy/storybook      Storybook detected — validate stories against tokens" },
    { text: "" },
    { text: "Install all recommended plugins?" },
    { text: "  buoy dock -y", type: "info" },
  ]} />

  <!-- ─────────────────────────────────────────── -->
  <h2 id="tokens">buoy dock tokens</h2>

  <p>
    Generate design tokens from values detected in your codebase. Outputs to
    CSS variables, JSON, Tailwind config, or AI-friendly context.
  </p>

  <DocTerminal command="buoy dock tokens [options]" />

  <h3>Options</h3>

  <Flags items={[
    { name: "-o, --output <path>", description: "Output file path (auto-detected if not specified)" },
    { name: "--format <format>", description: "Output format: css, json, tailwind, ai-context (auto-detected)" },
    { name: "--dry-run", description: "Preview without writing files" },
    { name: "--prefix <prefix>", description: 'Prefix for CSS custom properties (e.g., "ds-")' },
  ]} />

  <h3>Examples</h3>

  <h4>Generate CSS variables</h4>

  <DocTerminal command="buoy dock tokens --format css" lines={[
    { text: "" },
    { text: ":root {" },
    { text: "  --color-primary: #3b82f6;" },
    { text: "  --color-secondary: #64748b;" },
    { text: "  --spacing-sm: 8px;" },
    { text: "  --spacing-md: 16px;" },
    { text: "  --spacing-lg: 24px;" },
    { text: "}" },
  ]} />

  <h4>Generate Tailwind extension</h4>

  <DocTerminal command="buoy dock tokens --format tailwind -o tailwind.tokens.js" />

  <h4>Generate AI context</h4>

  <DocTerminal command="buoy dock tokens --format ai-context" lines={[
    { text: "" },
    { text: "Use for AI agents to understand available tokens with usage context." },
  ]} />

  <h3>Output Formats</h3>

  <ul>
    <li><strong>css</strong> - CSS custom properties (:root variables)</li>
    <li><strong>json</strong> - Standard JSON token format</li>
    <li><strong>tailwind</strong> - Tailwind CSS theme extension</li>
    <li><strong>ai-context</strong> - Markdown with token intent and usage</li>
  </ul>

  <LeadMagnetCallout
    leadMagnet="token-migration"
    headline="Planning a design token migration?"
    subhead="Step-by-step playbook for migrating from hardcoded values to design tokens. Avoid the common pitfalls."
    buttonText="Get the Playbook"
    class="my-8"
  />

  <h3>Compare token sources</h3>

  <p>
    Compare your codebase values against a design tokens file. Identifies which values in
    your code don't match any defined tokens.
  </p>

  <DocTerminal command="buoy dock tokens compare <tokens-file> [options]" />

  <Flags items={[
    { name: "<tokens-file>", description: "Path to design tokens file (JSON, CSS, or SCSS)", required: true },
    { name: "--json", description: "Output as JSON for scripting" },
    { name: "-v, --verbose", description: "Show per-file breakdown and usage frequency details" },
    { name: "--strict", description: "Fail if any unmatched values found" },
  ]} />

  <h4>Supported Token Formats</h4>

  <p><strong>Design Tokens JSON (W3C format)</strong></p>

  <CodeBlock code={`{
  "color": {
    "primary": { "$value": "#3b82f6" },
    "secondary": { "$value": "#64748b" }
  },
  "spacing": {
    "sm": { "$value": "8px" },
    "md": { "$value": "16px" }
  }
}`} language="json" />

  <p><strong>Tokens Studio / Figma Export</strong></p>

  <CodeBlock code={`{
  "colors": {
    "blue-500": "#3b82f6",
    "gray-500": "#64748b"
  }
}`} language="json" />

  <p><strong>CSS Custom Properties</strong></p>

  <CodeBlock code={`:root {
  --color-primary: #3b82f6;
  --spacing-md: 16px;
}`} language="css" />

  <h4>Example Output</h4>

  <DocTerminal command="buoy dock tokens compare design-tokens.json" lines={[
    { text: "" },
    { text: "Comparing against design-tokens.json..." },
    { text: "" },
    { text: "Token Coverage: 87%" },
    { text: "───────────────────" },
    { text: "" },
    { text: "Colors (78% coverage)" },
    { text: "  ✓ 18 values match tokens", type: "success" },
    { text: "  ✗ 5 values not in tokens:", type: "warning" },
    { text: "      #f9fafb (used 3 times in 2 files)" },
    { text: "      #374151 (used 2 times in 1 file)" },
    { text: "      #3b83f6 (used 1 time) ← typo? close to #3b82f6", type: "warning" },
    { text: "" },
    { text: "Spacing (86% coverage)" },
    { text: "  ✓ 12 values match tokens", type: "success" },
    { text: "  ✗ 2 values not in tokens:", type: "warning" },
    { text: "      15px (used 4 times in 3 files) ← close to 16px" },
    { text: "      13px (used 1 time)" },
  ]} />

  <h3>Import tokens</h3>

  <p>
    Import design tokens from external files. Supports JSON (DTCG, Tokens Studio,
    Style Dictionary) and CSS formats.
  </p>

  <DocTerminal command="buoy dock tokens import <file> [options]" />

  <Flags items={[
    { name: "file", description: "Token file to import (JSON, CSS)", required: true },
    { name: "-o, --output <path>", description: "Output file path", default: "design-tokens.css" },
    { name: "-f, --format <format>", description: 'Output format: css, json, scss', default: "css" },
    { name: "--dry-run", description: "Preview import without writing files" },
  ]} />

  <DocTerminal command="buoy dock tokens import tokens-studio-export.json" lines={[
    { text: "" },
    { text: "Importing tokens..." },
    { text: "" },
    { text: "Found 67 tokens:", type: "info" },
    { text: "  - 24 colors" },
    { text: "  - 12 spacing" },
    { text: "  - 8 typography" },
    { text: "  - 23 other" },
    { text: "" },
    { text: "✓ Created design-tokens.css", type: "success" },
  ]} />

  <!-- ─────────────────────────────────────────── -->
  <h2 id="graph">buoy dock graph</h2>

  <p>
    Build and query a knowledge graph of your design system. Understand
    relationships between components, tokens, and patterns.
  </p>

  <DocTerminal command="buoy dock graph <command> [options]" />

  <h3>Commands</h3>

  <Flags items={[
    { name: "build", description: "Build the knowledge graph from the codebase (persists to .buoy/graph.json)" },
    { name: "learn", description: "Analyze drift history for repeat patterns and learnings" },
    { name: 'query <question>', description: "Query the knowledge graph" },
    { name: "export", description: "Export the graph for visualization" },
    { name: "stats", description: "Show graph statistics" },
  ]} />

  <h3>Options</h3>

  <Flags items={[
    { name: "--incremental", description: "Only rebuild nodes for changed files (faster rebuilds)" },
    { name: "--json", description: "Output as JSON" },
  ]} />

  <h3>Examples</h3>

  <h4>Build the graph</h4>

  <DocTerminal command="buoy dock graph build" lines={[
    { text: "" },
    { text: "Building knowledge graph..." },
    { text: "" },
    { text: "Nodes: 156", type: "info" },
    { text: "  - 42 components" },
    { text: "  - 67 tokens" },
    { text: "  - 47 patterns" },
    { text: "" },
    { text: "Edges: 312 relationships" },
    { text: "" },
    { text: "Graph saved to .buoy/graph.json", type: "success" },
  ]} />

  <h4>Query the graph</h4>

  <DocTerminal command='buoy dock graph query "What components use the primary color?"' lines={[
    { text: "" },
    { text: "Components using --color-primary:" },
    { text: "  - Button (3 usages)" },
    { text: "  - Link (2 usages)" },
    { text: "  - Badge (1 usage)" },
    { text: "  - Tab (1 usage)" },
  ]} />

  <h4>Learn from drift history</h4>

  <p>
    Analyze your drift history to surface repeat patterns. Shows which mistakes you
    keep making so you can address the root cause.
  </p>

  <DocTerminal command="buoy dock graph learn" lines={[
    { text: "" },
    { text: "  Your Repeat Mistakes" },
    { text: "" },
    { text: "● Hardcoded Value in Button (5x)", type: "warning" },
    { text: "    Files: src/Button.tsx, src/IconButton.tsx, src/LinkButton.tsx" },
    { text: "    Fix: Use var(--color-primary) instead", type: "info" },
    { text: "" },
    { text: "● Arbitrary Spacing in Card (3x)", type: "warning" },
    { text: "    Files: src/Card.tsx, src/CardHeader.tsx" },
    { text: "    Fix: Use spacing.4 instead", type: "info" },
    { text: "" },
    { text: "Analyzed 10 scans, 47 total drifts", type: "muted" },
    { text: "Found 3 repeat patterns", type: "muted" },
  ]} />

  <!-- ─────────────────────────────────────────── -->
  <h2>Generated Files</h2>

  <ul>
    <li><strong>.buoy.yaml</strong> — Main configuration file</li>
    <li><strong>.claude/skills/</strong> — Buoy skills for Claude Code</li>
    <li><strong>.claude/agents/</strong> — AI agent definitions</li>
    <li><strong>.claude/commands/</strong> — Slash commands for Claude Code</li>
    <li><strong>CLAUDE.md</strong> — Design system context for AI tools</li>
  </ul>

  <h2>Related</h2>

  <ul>
    <li><a href="/docs/cli/show">buoy show</a> — View what's configured</li>
    <li><a href="/docs/cli/drift">buoy drift</a> — Detect and fix drift</li>
    <li><a href="/docs/integrations/claude-code">Claude Code</a> — AI integration details</li>
    <li><a href="/docs/features/ai-guardrails">AI Guardrails</a> — Full guide</li>
  </ul>
</DocsLayout>
